# Token Usage Tracking

This example goes over how to track your token usage for specific calls. It is currently only implemented for the OpenAI API.
You can then convert your token usage to a actual cost using the [OpenAI pricing page](https://openai.com/pricing/).
Thus you can monitor and compare the cost of different prompts/calls.

import CodeBlock from "@theme/CodeBlock";
import OpenAiCostExample from "@examples/callbacks/openai_cost.ts";
import OpenAiCostCumulExample from "@examples/callbacks/openai_cost_cumul.ts";

```typescript
const modelName = "text-davinci-003";
// create the callback handler
const cbHandler = new OpenAiCostCallbackHandler(modelName);
// use the callback handler in the model
const model = new OpenAI({ modelName, callbacks: [cbHandler] });
```

Let's look at a standalone example of tracking token usage for a single LLM call.

<CodeBlock language="typescript">{OpenAiCostExample}</CodeBlock>

### Using Cummulate Cost from Multiple Chains

A way to cumulate cost from various origins is provided as a convenience.

Suppose you want to track the cost of a given customer over multiple chains. 
You can will need to cumulate the cost of each messages, to cumulate to be the cost of a conversation.
then one can cumulate the cost of each conversation to get the total cost of a customer.

```typescript
// create a callback handler for a given chain
const cbHandler1 = new OpenAiCostCallbackHandler(modelName1);
const openaiCost1 = OpenAiTokenCost.fromCallbackHandler(cbHandler1);

// ...

// create a callback handler for another chain
const cbHandler2 = new OpenAiCostCallbackHandler(modelName2);
const openaiCost2 = OpenAiTokenCost.fromCallbackHandler(cbHandler2);

// ...

// Compute the cumulated cost of the two chains
const openaiCostCumul = openaiCost1.clone().add(openaiCost2);
```

Here is a simple example of cumulating the cost of two chains.

<CodeBlock language="typescript">{OpenAiCostCumulExample}</CodeBlock>
